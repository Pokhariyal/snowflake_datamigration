select count(distinct(line)) from (SELECT
                sh.*,
                sl.added_dte,
                sl.added_usr,
                sl.aeroxchange_repairs_process_request,
                sl.aerox_msg_purpose_indicator,
                sl.agent_commission,
                sl.alt1,
                sl.alt2,
                sl.bline,
                sl.blineyn,
                sl.buyer_code,
                sl.canceled,
                sl.category,
                sl.charge_amount,
                sl.close_qback,
                sl.cond,
                sl.contract_doc_no,
                sl.conv_doc,
                sl.conv_doc_category,
                sl.conv_ln,
                sl.cost,
                sl.cost1,
                sl.cost1_um,
                sl.cost2,
                sl.cost2_um,
                sl.cost3,
                sl.cost3_um,
                sl.cost_cap,
                sl.cost_curency,
                sl.cost_date,
                sl.cost_doc,
                sl.cost_docline,
                sl.cost_doc_category,
                sl.cost_factor,
                sl.cost_um,
                sl.custom_price,
                sl.custom_price_um,
                sl.cust_pn,
                sl.cutting_direction,
                sl.cutting_required,
                sl.c_agent_commission,
                sl.c_charge_amount,
                sl.c_cost,
                sl.c_cost_cap,
                sl.c_curency,
                sl.c_custom_price,
                sl.c_date,
                sl.c_doc_total,
                sl.c_exclude_part_cost,
                sl.c_factor,
                sl.c_price_per_piece,
                sl.c_price_per_weightum,
                sl.c_source_price_value,
                sl.c_tax_a_amt,
                sl.c_tax_b_amt,
                sl.c_tax_c_amt,
                sl.c_tax_c_perc,
                sl.c_unitp,
                sl.c_unitp1,
                sl.c_unitp2,
                sl.c_unitp3,
                sl.descriptn,
                sl.discount,
                sl.discount_type,
                sl.dlv,
                sl.early_shipment,
                sl.exclude_part_cost,
                sl.exclude_part_cost_reason,
                sl.exclusions,
                sl.factor,
                sl.hold,
                sl.hpost,
                sl.import_export_license,
                sl.import_export_override,
                sl.import_export_required,
                sl.last_price_approved,
                sl.length_from,
                sl.length_from_ttl,
                sl.length_to_ttl,
                sl.line,
                sl.line_ref,
                sl.line_type,
                sl.logno,
                sl.lstatus,
                sl.max_sell,
                sl.mfg,
                sl.mfg_subc,
                sl.min_qty,
                sl.min_sell,
                sl.nocharge,
                sl.note,
                sl.no_charge,
                sl.partnumber,
                sl.partserial,
                sl.part_ssn,
                sl.picked_by,
                sl.picked_on,
                sl.pick_location,
                sl.pick_status,
                sl.piece_length,
                sl.piece_width,
                sl.pn_rcv_as,
                sl.pn_rcv_as_subp,
                sl.pn_rcv_logno,
                sl.price_approval_date,
                sl.price_approved_by,
                sl.price_by_weight,
                sl.price_contract_doc_no,
                sl.price_contract_type,
                sl.price_per_piece,
                sl.price_per_weightum,
                sl.printed,
                sl.printline,
                sl.prn_pn_memo1,
                sl.prn_pn_memo2,
                sl.qback,
                sl.qorder,
                sl.qreq,
                sl.qschedule,
                sl.qship,
                sl.qty_change,
                sl.qty_change_um,
                sl.qty_convert,
                sl.qty_factor,
                sl.qty_instockrev,
                sl.qty_um,
                sl.received_by,
                sl.received_on,
                sl.reclock,
                sl.recomm_doc,
                sl.recomm_doc_category,
                sl.recomm_ln,
                sl.ref1,
                sl.ref2,
                sl.ref3,
                sl.released_by,
                sl.released_on,
                sl.replenishment_cost,
                sl.requested_partnumber,
                sl.requested_pn_subp,
                sl.reserved_by,
                sl.reserved_on,
                sl.rng,
                sl.rohs_compliance,
                sl.serial_no,
                sl.ship_confirmed,
                sl.source_category,
                sl.source_doc_no,
                sl.source_line,
                sl.source_price,
                sl.source_price_value,
                sl.status,
                sl.stock_tax_amt,
                sl.stock_tax_calc,
                sl.stock_tax_perc,
                sl.subp,
                sl.subt_tax_a,
                sl.subt_tax_b,
                sl.subt_tax_c,
                sl.total_weight,
                sl.uline1,
                sl.uline2,
                sl.under_warranty,
                sl.unitp,
                sl.unitp1,
                sl.unitp1_um,
                sl.unitp2,
                sl.unitp2_um,
                sl.unitp3,
                sl.unitp3_um,
                sl.unitp_um,
                sl.updated_dte,
                sl.updated_usr,
                sl.vol_from,
                sl.vol_from_ttl,
                sl.vol_to_ttl,
                sl.weight_per_piece,
                sl.wght_from,
                sl.wght_from_ttl,
                sl.wght_to_ttl,
                sl.work_requested
              ,
                s2.adr1,
                s2.adr2,
                s2.adr3,
                s2.city,
                s2.country,
                s2.county,
                s2.fax1,
                s2.fax2,
                s2.internet,
                s2.invoice_type,
                s2.isactive,
                s2.m1_tax_c,
                s2.m2_tax_c,
                s2.m3_tax_c,
                s2.m4_tax_c,
                s2.m5_tax_c,
                s2.m6_tax_c,
                s2.name,
                s2.pad,
                s2.paid_by_ach,
                s2.paid_by_wire,
                s2.region,
                s2.registration_no,
                s2.registration_upd,
                s2.registration_valid,
                s2.ship_code,
                s2.ship_no,
                s2.ship_type,
                s2.sita,
                s2.spc_2000_c,
                s2.spec2000,
                s2.state,
                s2.tel1,
                s2.tel1_ext,
                s2.tel2,
                s2.tel2_ext,
                s2.tel_pfix,
                s2.web_site,
                s2.zip
            FROM
                    adp_so_line sl 
                JOIN adp_so_hdr sh ON sh.doc_no = sl.doc_no 
                              inner join adp_shipto s2    
                                  ON sl.acctno = s2.acctno
                         AND sl.subc = s2.subc
                                  where upper(s2.ship_type) ='S');
                         
